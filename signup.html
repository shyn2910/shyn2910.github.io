<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>Đăng ký - ShynMMO Games</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
<style>
body{background:#0b0f19;color:#fff;font-family:Inter;margin:0;padding:40px}
.card{max-width:480px;margin:40px auto;background:rgba(255,255,255,.05);padding:30px;border-radius:20px;box-shadow:0 0 20px rgba(0,0,0,.5)}
input{width:100%;padding:12px;border-radius:10px;border:none;margin:8px 0;background:#121826;color:#fff}
button{padding:12px 20px;border:none;border-radius:10px;background:#22d3ee;color:#000;font-weight:700;cursor:pointer}
button:hover{background:#67e8f9}
a{color:#22d3ee;text-decoration:none}
footer{position:fixed;right:20px;bottom:10px;color:#888;font-size:12px;opacity:.6}
</style>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script src="./js/firebase.js"></script>
<script src="./js/util.js"></script>
</head>
<body>
<div class="card">
  <h2>Đăng ký tài khoản</h2>
  <input id="username" placeholder="Tên người dùng (duy nhất)">
  <input id="email" type="email" placeholder="Địa chỉ Gmail">
  <input id="password" type="password" placeholder="Mật khẩu">
  <button id="btnSignup">Đăng ký</button>
  <p>Đã có tài khoản? <a href="login.html">Đăng nhập</a></p>
</div>
<footer>© ShynMMO Games 2025</footer>

<script>
const $u = $('#username'), $e = $('#email'), $p = $('#password');

$('#btnSignup').onclick = async ()=>{
  const username = $u.value.trim().toLowerCase();
  const email = $e.value.trim();
  const pass = $p.value.trim();
  if(!username || !email || !pass) return toast("Vui lòng nhập đầy đủ thông tin");
  const unameRef = _db.ref('usernames/'+username);
  if((await unameRef.get()).exists()) return toast("Tên người dùng đã tồn tại");

  try{
    const userCred = await _auth.createUserWithEmailAndPassword(email, pass);
    const uid = userCred.user.uid;
    await unameRef.set({uid,email});
    await _db.ref('users/'+uid).set({
      username,
      email,
      balance:0,
      wins:0,
      losses:0,
      role:'user',
      locked:false,
      createdAt:Date.now()
    });
    toast("Đăng ký thành công, chuyển đến đăng nhập...");
    setTimeout(()=>location.href='login.html',1500);
  }catch(err){
    toast("Lỗi: "+err.message);
  }
};
</script>
</body>
</html>
