<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>üí¨ ShynChat Pro v6.0 | ShynSuite</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.2/firebase-database-compat.js"></script>

<style>
body {
  margin: 0; padding: 0;
  font-family: 'Be Vietnam Pro', sans-serif;
  background: #0d0d0d; color: #fff;
  text-align: center;
}
header {
  padding: 15px;
  font-size: 1.5em;
  color: #ff2e2e;
  text-shadow: 0 0 15px #ff0000, 0 0 30px #ff2e2e;
}
#chatBox {
  width: 80%;
  max-width: 700px;
  margin: auto;
  background: #111;
  border-radius: 10px;
  padding: 10px;
  box-shadow: 0 0 25px #ff2e2e55;
}
#messages {
  height: 400px;
  overflow-y: auto;
  border: 1px solid #222;
  padding: 10px;
  border-radius: 10px;
  text-align: left;
  background: #000;
}
.message {
  margin-bottom: 8px;
  padding: 6px 10px;
  border-radius: 8px;
  background: #1a1a1a;
}
.sender {
  color: #ff2e2e;
  font-weight: 600;
}
#inputArea {
  margin-top: 10px;
}
#messageInput {
  width: 70%;
  padding: 8px;
  border-radius: 8px;
  border: none;
  outline: none;
}
button {
  background: #ff2e2e;
  border: none;
  color: white;
  padding: 8px 14px;
  border-radius: 6px;
  cursor: pointer;
  margin-left: 5px;
}
button:hover {
  background: #ff5555;
  box-shadow: 0 0 10px #ff2e2e;
}
#adminPanel {
  position: fixed;
  top: 60px;
  right: 20px;
  width: 320px;
  background: rgba(20, 0, 0, 0.9);
  border: 1px solid #ff2e2e88;
  box-shadow: 0 0 15px #ff0000aa;
  border-radius: 10px;
  padding: 10px;
  display: none;
  z-index: 1000;
  text-align: left;
}
#adminPanel h3 {
  color: #ff2e2e;
  text-shadow: 0 0 10px #ff0000;
}
#adminPanel button {
  margin-top: 5px;
}
#toggleAdmin {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #ff2e2e;
  border-radius: 50%;
  width: 55px;
  height: 55px;
  box-shadow: 0 0 20px #ff0000aa;
  border: none;
  cursor: pointer;
  color: white;
  font-size: 1.3em;
  display: none;
}
footer {
  margin-top: 20px;
  opacity: 0.6;
  font-size: 0.9em;
}
</style>
</head>
<body>

<header>üí¨ ShynChat Pro v6.0 | ShynSuite</header>

<div id="loginDiv">
  <button id="loginBtn">ƒêƒÉng nh·∫≠p b·∫±ng Google</button>
</div>

<div id="chatBox" style="display:none">
  <div id="userName"></div>
  <div id="messages"></div>
  <div id="inputArea">
    <input type="text" id="messageInput" placeholder="Nh·∫≠p tin nh·∫Øn..." />
    <button id="sendBtn">G·ª≠i</button>
    <button id="logoutBtn">ƒêƒÉng xu·∫•t</button>
  </div>
</div>

<!-- N√∫t b·∫≠t/t·∫Øt b·∫£ng Admin -->
<button id="toggleAdmin">üëë</button>

<!-- B·∫£ng Admin -->
<div id="adminPanel">
  <h3>üëë B·∫£ng ƒëi·ªÅu khi·ªÉn Admin</h3>
  <div id="userList"></div>
  <button id="clearChatBtn">üßπ X√≥a to√†n b·ªô chat</button>
</div>

<footer>Created by <b>ShynMMO ¬©2025</b> | Powered by Firebase</footer>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDs3VrMSUnb7kl0MWYbMxnqR78anJ2SgJs",
  authDomain: "shynchat.firebaseapp.com",
  databaseURL: "https://shynchat-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "shynchat",
  storageBucket: "shynchat.firebasestorage.app",
  messagingSenderId: "180611398927",
  appId: "1:180611398927:web:2566534da0f8f6935f927a"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

const ADMIN_EMAIL = "pn23070999@gmail.com";
const loginBtn = document.getElementById("loginBtn");
const loginDiv = document.getElementById("loginDiv");
const chatBox = document.getElementById("chatBox");
const messages = document.getElementById("messages");
const msgInput = document.getElementById("messageInput");
const sendBtn = document.getElementById("sendBtn");
const logoutBtn = document.getElementById("logoutBtn");
const toggleAdmin = document.getElementById("toggleAdmin");
const adminPanel = document.getElementById("adminPanel");
const userList = document.getElementById("userList");
const clearChatBtn = document.getElementById("clearChatBtn");

const provider = new firebase.auth.GoogleAuthProvider();
let currentUser = null;

loginBtn.onclick = () => auth.signInWithPopup(provider).catch(err => alert("L·ªói: " + err.message));
logoutBtn.onclick = () => auth.signOut();

auth.onAuthStateChanged(user => {
  if (!user) {
    chatBox.style.display = "none";
    loginDiv.style.display = "block";
    toggleAdmin.style.display = "none";
    return;
  }

  currentUser = user;
  loginDiv.style.display = "none";
  chatBox.style.display = "block";
  document.getElementById("userName").innerHTML = `<b>${user.displayName}</b> (${user.email})`;

  db.ref("users/" + user.uid).update({
    name: user.displayName,
    email: user.email,
    online: true
  });

  loadMessages();

  if (user.email.toLowerCase() === ADMIN_EMAIL.toLowerCase()) {
    toggleAdmin.style.display = "block";
    loadAdminPanel();
  }
});

window.onbeforeunload = () => {
  if (currentUser) db.ref("users/" + currentUser.uid + "/online").set(false);
};

function loadMessages() {
  db.ref("rooms/public").on("child_added", snap => {
    const m = snap.val();
    const div = document.createElement("div");
    div.className = "message";
    div.innerHTML = `<span class='sender'>${m.sender}:</span> ${m.text}`;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  });
}

sendBtn.onclick = () => {
  if (!msgInput.value.trim()) return;
  db.ref("rooms/public").push({
    sender: currentUser.displayName,
    text: msgInput.value.trim(),
    time: Date.now()
  });
  msgInput.value = "";
};

toggleAdmin.onclick = () => {
  adminPanel.style.display = adminPanel.style.display === "block" ? "none" : "block";
};

function loadAdminPanel() {
  db.ref("users").on("value", snap => {
    userList.innerHTML = "";
    snap.forEach(child => {
      const u = child.val();
      const div = document.createElement("div");
      div.innerHTML = `
        <b>${u.name || "Kh√¥ng t√™n"}</b> - ${u.email || ""}
        (${u.online ? "üü¢" : "üî¥"})
        <button onclick="banUser('${child.key}')">Ban</button>
      `;
      userList.appendChild(div);
    });
  });
}

function banUser(uid) {
  if (confirm("C·∫•m ng∆∞·ªùi d√πng n√†y?")) {
    db.ref("users/" + uid).remove();
    alert("ƒê√£ c·∫•m user th√†nh c√¥ng!");
  }
}

clearChatBtn.onclick = () => {
  if (confirm("X√≥a to√†n b·ªô tin nh·∫Øn ph√≤ng chung?")) {
    db.ref("rooms/public").remove();
    alert("ƒê√£ x√≥a to√†n b·ªô chat!");
  }
};
</script>
</body>
</html>
